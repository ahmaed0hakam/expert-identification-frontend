<div class="container-main">
  <!-- Folder Header -->
  <div class="folder-header">
    <button (click)="goBack()" class="back-button">
      <app-icon name="arrow-left" size="20"></app-icon>
      <span>{{ 'common.back' | translate }}</span>
    </button>
    
    <div *ngIf="folder()" class="folder-info">
      <div class="folder-icon-large">
        <app-icon name="folder" size="32"></app-icon>
      </div>
      <div class="folder-details">
        <h1 class="folder-title">{{ folder()!.name }}</h1>
        <p *ngIf="folder()!.description" class="folder-description">{{ folder()!.description }}</p>
        <div class="folder-stats">
          <span class="stat-badge">
            <app-icon name="image" size="16"></app-icon>
            {{ total() }} {{ 'user.images' | translate }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-section">
    <div class="search-wrapper">
      <app-icon name="search" size="20" class="search-icon"></app-icon>
      <input
        type="text"
        [ngModel]="searchTerm()"
        (ngModelChange)="searchTerm.set($event); onSearchInput()"
        [placeholder]="'user.searchImages' | translate"
        class="search-input"
      />
      <button
        *ngIf="searchTerm()"
        (click)="clearSearch()"
        class="clear-search-btn"
        [attr.aria-label]="'common.clear' | translate"
      >
        <app-icon name="x" size="16"></app-icon>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="loading-container">
    <div class="spinner"></div>
    <p class="loading-text">{{ 'common.loading' | translate }}</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading() && images().length === 0" class="empty-state">
    <div class="empty-icon">
      <app-icon name="image" size="80"></app-icon>
    </div>
    <h3 class="empty-title">{{ searchTerm() ? ('user.noSearchResults' | translate) : ('user.noImages' | translate) }}</h3>
    <p class="empty-description">
      {{ searchTerm() ? ('user.tryDifferentSearch' | translate) : ('user.folderEmpty' | translate) }}
    </p>
  </div>

  <!-- Images Grid -->
  <div *ngIf="!isLoading() && images().length > 0" class="images-grid">
    <div
      *ngFor="let image of images(); trackBy: trackById"
      class="image-card"
      (click)="showImageDetails(image)"
    >
      <div class="image-container">
        <img
          [src]="getImageUrl(image)"
          [alt]="image.title"
          class="gallery-image"
          (error)="onImageError($event)"
        />
        <div class="image-overlay">
          <div class="image-info">
            <h3 class="image-title">{{ image.title }}</h3>
            <p *ngIf="image.category" class="image-category">{{ image.category }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div *ngIf="!isLoading() && totalPages() > 1 && !searchTerm()" class="pagination">
    <button
      (click)="previousPage()"
      [disabled]="currentPage() === 0"
      class="pagination-button"
      [class.disabled]="currentPage() === 0"
    >
      <app-icon name="arrow-left" size="20"></app-icon>
      <span>{{ 'common.previous' | translate }}</span>
    </button>
    <div class="pagination-info">
      <span class="pagination-text">
        {{ 'common.page' | translate }} {{ currentPage() + 1 }} {{ 'common.of' | translate }} {{ totalPages() }}
      </span>
    </div>
    <button
      (click)="nextPage()"
      [disabled]="currentPage() >= totalPages() - 1"
      class="pagination-button"
      [class.disabled]="currentPage() >= totalPages() - 1"
    >
      <span>{{ 'common.next' | translate }}</span>
      <app-icon name="arrow-right" size="20"></app-icon>
    </button>
  </div>

  <!-- Image Detail Modal -->
  <app-image-detail-modal
    [isOpen]="showImageDetail()"
    [image]="selectedImageDetail()"
    [imageUrl]="selectedImageDetailUrl()"
    (closeModal)="closeImageDetail()"
  ></app-image-detail-modal>
</div>
